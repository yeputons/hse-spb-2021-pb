Цель занятия: дать минимальный набор теории и команд, необходимый для сдачи домашек по C++ через консоль и исправления ошибок.
Не цель: использовать git для разработки командного проекта

* Git - одна из самых популярны DVCS (есть ещё Mercurial)
  * Мы используем консольный клиент
* Есть GitHub - это хостинг для репозиториев
  * Pull Request - фишка конкретно GitHub, позволяет смотреть на разницу между двумя ветками.

Книга Pro Git: https://git-scm.com/book/ru/v2
Игрушечные версии, там только примерные команды:
* https://learngitbranching.js.org/
* https://git-school.github.io/visualizing-git/

Упражнения с реальным (чуть модифицированным) git: https://gitexercises.fracz.com/

# Настройка контроля доступа на GitHub (SSH-ключ)
https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account
https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent

# Модель данных
Git vs GitHub, git clone
(?) Проблемы с переводами строк
git log
git log --all --graph --decorate --oneline и ungit

У каждого коммита уникальный хэш (как блокчейн), обычно называют по префиксу
На коммит можно смотреть по-разному: либо это разница с предыдущей версией, либо это состояние репозитория. Второе проще.

## Основное про Git [00:10]
* Храним один набор файлов целиком, версия - полное состояние файлов (и промежуточных папок)
  * Если файлы текстовые, то меняются несильно, можно "под капотом" оптимизировать
  * Если файлы бинарные, то копируются целиком => репозиторий большой
* История - направленный граф (КАРТИНКА)
  * Вершины - версии (коммиты), есть хэш (потому что распределённость)
    * Также "коммитом" называется: создание новой версии, изменения между версией и предыдущей
  * Рёбра ведут в предыдущие версии (обычно одно, но бывает и больше при merge/слиянии)
  * Вершины никогда не удаляются, данные только добавляются
* Есть "ветки" и "тэги": указатели на коммиты
  * Тэг по-хорошему не двигается (`0.7.4-alpha`)
  * Ветка двигается с разработкой (`master`, `issue-1365`)
* Все операции идут локально, синхронизация с сервером - отдельный процесс
  * Для git непринципиально, "репозиторий" только локальный или с зеркалом на GitHub или ещё где-то.
  * Есть зеркала вроде github.com/torvalds/linux
  * Локально мы храним и локальный репозиторий, и удалённый, и помним про все ветки (`origin`, `upstream`).

## Как использовать
* Репозиторий хранит исходный код, из которого можно собрать. Не то, что зависит от ОС и/или можно сгенерировать:
  * Бинарники и промежуточные файлы
  * Настройки среды, особенно на конкретном компьютере (`.idea` иногда можно, но без `workspace.xml`)
  * Временные файлы: логи, папки для тестов, файлы для тестов
* Для этого надо настроить `.gitignore`, можно себе на компьютере настроить глобальный, можно в конкретном репозитории настроить `.git/config/exclude`
* Что-то хоть чуть-чуть заработало/закончено? Коммит, чтобы было удобно смотреть "а что я поменял по сравнению с предыдущей версией".
* Хотите эксперимент? Создаёте ветку, в ней экспериментируете (можно даже на сервер класть, чтобы показывать/CI запускать), в крайнем случае удаляете.
* Пока не говорим про командную разработку: там важны описания коммитов, их содержимое, названия веток, ведение нескольких веток одновременно, да и `master` менять можно.

# Добавление коммитов
Настройка локального git: user.name, user.email, editor
Состояние: переключение между ветками, HEAD, папка `.git`
git status
.gitignore и что класть в репозиторий
git diff, git diff --staged

Внезапное: `git add` сохраняет только конкретное состояние: https://git-scm.com/book/ru/v2/%D0%9E%D1%81%D0%BD%D0%BE%D0%B2%D1%8B-Git-%D0%97%D0%B0%D0%BF%D0%B8%D1%81%D1%8C-%D0%B8%D0%B7%D0%BC%D0%B5%D0%BD%D0%B5%D0%BD%D0%B8%D0%B9-%D0%B2-%D1%80%D0%B5%D0%BF%D0%BE%D0%B7%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D0%B9

Ошибка: закоммитили лишний файл в pull request, надо удалить и закоммитить. Не revert.

Ошибка: забыли файл или опечатались. Надо делать новый коммит. Если сделать amend, то это переписывание истории.

# fetch и синхронизация
Когда поменяли через веб-интерфейс или я что-то обновил: сначала обновить origin, потом склеить ветки при помощи `merge --ff-only`.

Полезности: `git stash --help`.

(?) почему переписывание истории - это плохо

# Перенос веток и `push --force-with-lease`
Ошибка: коммит в master
Ошибка: cлучайный merge (при pull)
 